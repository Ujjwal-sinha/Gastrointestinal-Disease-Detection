<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gastrointestinal Polyp Detection - Workflow Diagrams</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #20b2aa 0%, #008b8b 100%);
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #20b2aa 0%, #008b8b 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        .content {
            padding: 30px;
        }
        .diagram-section {
            margin-bottom: 60px;
            padding: 30px;
            border-radius: 15px;
            background: #f8f9fa;
            border-left: 8px solid #20b2aa;
        }
        .diagram-title {
            color: #20b2aa;
            margin: 0 0 20px 0;
            font-size: 2em;
            text-align: center;
        }
        .diagram-description {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.1em;
            line-height: 1.6;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        .download-section {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #fef5e7;
            border-radius: 10px;
        }
        .download-btn {
            background: #20b2aa;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 0 10px;
            text-decoration: none;
            display: inline-block;
        }
        .download-btn:hover {
            background: #008b8b;
        }
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #20b2aa;
        }
        .feature-card h4 {
            color: #20b2aa;
            margin: 0 0 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü©∫ Gastrointestinal Polyp Detection System</h1>
            <p>AI-Powered Gastrointestinal Polyp Classification Workflow with YOLO Deep Learning</p>
        </div>
        
        <div class="content">
            <!-- Phase 1: Endoscopic Image Upload & Quality Validation -->
            <div class="diagram-section">
                <h2 class="diagram-title">Phase 1: Endoscopic Image Upload & Quality Validation</h2>
                <p class="diagram-description">
                    Initial phase where the user uploads a gastrointestinal endoscopic image, followed by quality validation and preprocessing.
                    This includes format validation, quality scoring, and endoscopic-specific image optimization for accurate polyp detection.
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        participant User
                        participant StreamApp
                        participant ImageValidator
                        participant EndoscopicProcessor
                        participant ValidatedImage

                        Note over User, ValidatedImage: Phase 1: Endoscopic Image Upload & Quality Validation

                        User->>StreamApp: Upload Endoscopic Image
                        StreamApp->>StreamApp: Validate File Format (PNG/JPG/JPEG)
                        StreamApp->>ImageValidator: Check Image Quality
                        ImageValidator->>ImageValidator: Quality Score Calculation (0-1 scale)
                        ImageValidator->>EndoscopicProcessor: Quality Validated Image
                        EndoscopicProcessor->>EndoscopicProcessor: Endoscopic Image Normalization
                        EndoscopicProcessor->>EndoscopicProcessor: Contrast Enhancement (CLAHE)
                        EndoscopicProcessor->>EndoscopicProcessor: Resolution Standardization (640x640)
                        EndoscopicProcessor->>ValidatedImage: Processed Endoscopic Image

                        Note over User, ValidatedImage: Endoscopic preprocessing completed, ready for polyp classification
                </div>
            </div>

            <!-- Phase 2: YOLO Polyp Classification -->
            <div class="diagram-section">
                <h2 class="diagram-title">Phase 2: YOLO Polyp Classification</h2>
                <p class="diagram-description">
                    Advanced AI classification phase where YOLO11m analyzes the endoscopic image for gastrointestinal polyp detection with
                    real-time object detection, confidence scoring, and polyp type identification using deep learning.
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        participant ValidatedImage
                        participant YOLOModel
                        participant FeatureExtractor
                        participant DetectionHead
                        participant PolypClassifier
                        participant ConfidenceScorer

                        Note over ValidatedImage, ConfidenceScorer: Phase 2: YOLO Polyp Classification

                        ValidatedImage->>YOLOModel: Send Processed Endoscopic Image (640x640)
                        YOLOModel->>FeatureExtractor: Deep Feature Extraction (Conv Layers)
                        FeatureExtractor->>FeatureExtractor: Multi-layer Convolution & Pooling
                        FeatureExtractor->>DetectionHead: Extracted Feature Maps
                        DetectionHead->>DetectionHead: Object Detection Layers
                        DetectionHead->>PolypClassifier: Raw Detection Scores
                        PolypClassifier->>PolypClassifier: Multi-class Polyp Classification
                        PolypClassifier->>ConfidenceScorer: Polyp Type Prediction
                        ConfidenceScorer->>ConfidenceScorer: Confidence Score Calculation
                        ConfidenceScorer->>ConfidenceScorer: Probability Calibration (90%+ threshold)

                        Note over ValidatedImage, ConfidenceScorer: Polyp classification completed with high confidence scoring
                </div>
            </div>

            <!-- Phase 3: AI Agent Medical Analysis -->
            <div class="diagram-section">
                <h2 class="diagram-title">Phase 3: AI Agent Medical Analysis</h2>
                <p class="diagram-description">
                    AI-powered medical analysis using GastrointestinalPolypAIAgent for polyp assessment and treatment recommendations.
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        participant ConfidenceScorer
                        participant GastrointestinalPolypAgent
                        participant TreatmentAdvisor
                        participant Report

                        Note over ConfidenceScorer, Report: Phase 3: AI Medical Analysis

                        ConfidenceScorer->>GastrointestinalPolypAgent: Classification Results
                        GastrointestinalPolypAgent->>GastrointestinalPolypAgent: Medical Analysis
                        GastrointestinalPolypAgent->>TreatmentAdvisor: Polyp Assessment
                        TreatmentAdvisor->>TreatmentAdvisor: Generate Recommendations
                        TreatmentAdvisor->>Report: Complete Analysis

                        Note over ConfidenceScorer, Report: Analysis completed
                </div>
            </div>

            <!-- Phase 4: Polyp Region Detection & Reporting -->
            <div class="diagram-section">
                <h2 class="diagram-title">Phase 4: Polyp Region Detection & Reporting</h2>
                <p class="diagram-description">
                    Polyp region detection, visualization generation, and PDF report creation for clinical documentation.
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        participant Analysis
                        participant Detector
                        participant Visualizer
                        participant Report
                        participant User

                        Note over Analysis, User: Phase 4: Detection & Reporting

                        Analysis->>Detector: Classification Results
                        Detector->>Detector: Polyp Region Detection
                        Detector->>Visualizer: Annotated Image
                        Visualizer->>Visualizer: Generate Explanations
                        Visualizer->>Report: Visualizations & Findings
                        Report->>Report: Compile PDF Report
                        Report->>User: Download Report

                        Note over Analysis, User: Report completed
                </div>
            </div>

            <!-- System Features -->
            <div class="download-section">
                <h3>üìä System Features & Capabilities</h3>
                <p style="margin-bottom: 20px;">Advanced gastrointestinal polyp detection system with comprehensive AI-powered analysis</p>

                <div class="feature-list">
                    <div class="feature-card">
                        <h4>ü©∫ Gastrointestinal Polyp Detection</h4>
                        <p>2 polyp categories: Polyp (abnormal growth), No Polyp (healthy tissue)</p>
                    </div>

                    <div class="feature-card">
                        <h4>üéØ YOLO Classification</h4>
                        <p>Real-time YOLO11m model with 640x640 input, object detection, and high confidence scoring</p>
                    </div>

                    <div class="feature-card">
                        <h4>üñºÔ∏è Endoscopic Image Processing</h4>
                        <p>Image quality validation, contrast enhancement (CLAHE), normalization, and resolution standardization</p>
                    </div>

                    <div class="feature-card">
                        <h4>ü§ñ AI Agents</h4>
                        <p>GastrointestinalPolypAIAgent with LangChain integration, medical analysis, and clinical recommendations</p>
                    </div>

                    <div class="feature-card">
                        <h4>üî• Explainable AI</h4>
                        <p>LIME, SHAP, and Grad-CAM visualizations for model interpretability and decision transparency</p>
                    </div>

                    <div class="feature-card">
                        <h4>üìã Medical Reports</h4>
                        <p>Comprehensive PDF reports with polyp findings, classifications, treatment recommendations, and visualizations</p>
                    </div>

                    <div class="feature-card">
                        <h4>‚öïÔ∏è Clinical Support</h4>
                        <p>Treatment protocols, endoscopic recommendations, prognosis assessment, and follow-up planning</p>
                    </div>

                    <div class="feature-card">
                        <h4>üìä Performance Metrics</h4>
                        <p>Real-time confidence scoring, image quality assessment, and classification validation</p>
                    </div>
                </div>

                <div style="margin-top: 30px;">
                    <p><strong>Classification Accuracy:</strong> High accuracy YOLO11m model with 90%+ confidence threshold</p>
                    <p><strong>Polyp Types:</strong> Polyp (Abnormal Growth), No Polyp (Healthy Tissue)</p>
                    <p><strong>Technology Stack:</strong> YOLO11m, PyTorch, Streamlit, LangChain, GROQ API, OpenCV, LIME, SHAP</p>
                </div>
            </div>

            <!-- Workflow Overview -->
            <div class="diagram-section">
                <h2 class="diagram-title">Complete System Workflow</h2>
                <p class="diagram-description">
                    End-to-end workflow showing all four phases integrated for comprehensive gastrointestinal polyp detection and analysis
                </p>
                <div class="mermaid">
                    flowchart TB
                        A[ü©∫ Upload Endoscopic Image] --> B[üìä Quality Validation]
                        B --> C[üîç Endoscopic Image Processing]
                        C --> D[üñºÔ∏è Normalization (640x640)]
                        D --> E[‚ú® Contrast Enhancement (CLAHE)]
                        E --> F[üéØ YOLO Polyp Classification]
                        F --> G[üîç Feature Extraction]
                        G --> H[‚úÖ Confidence Scoring]
                        H --> I[üéØ Polyp Region Detection]
                        I --> J[üè• AI Agent Medical Analysis]
                        J --> K[‚ö†Ô∏è Risk Assessment]
                        K --> L[üíä Treatment Recommendations]
                        L --> M[üî• Generate LIME/SHAP]
                        M --> N[üé® Generate Grad-CAM]
                        N --> O[üìã Compile Medical Report]
                        O --> P[üìÑ Generate PDF]
                        P --> Q[üì• Download Complete Report]

                        style A fill:#fed7d7,stroke:#20b2aa,stroke-width:3px
                        style F fill:#dcfce7,stroke:#48bb78,stroke-width:3px
                        style J fill:#fef5e7,stroke:#ed8936,stroke-width:3px
                        style O fill:#e6fffa,stroke:#38b2ac,stroke-width:3px
                        style Q fill:#20b2aa,stroke:#008b8b,stroke-width:3px,color:#ffffff
                </div>
            </div>

            <!-- Multi-Agent Workflow -->
            <div class="diagram-section">
                <h2 class="diagram-title">Multi-Agent Workflow</h2>
                <p class="diagram-description">
                    Detailed workflow showing the three specialized AI agents working together for comprehensive polyp analysis
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        participant Image
                        participant DataPreprocessingAgent
                        participant ModelTrainingAgent
                        participant EvaluationAgent
                        participant Orchestrator
                        participant FinalReport

                        Note over Image, FinalReport: Multi-Agent Polyp Analysis Workflow

                        Image->>DataPreprocessingAgent: Raw Endoscopic Image
                        DataPreprocessingAgent->>DataPreprocessingAgent: Image Enhancement
                        DataPreprocessingAgent->>DataPreprocessingAgent: Quality Assessment
                        DataPreprocessingAgent->>Orchestrator: Enhanced Image + Quality Score

                        Orchestrator->>ModelTrainingAgent: Enhanced Image
                        ModelTrainingAgent->>ModelTrainingAgent: YOLO Model Optimization
                        ModelTrainingAgent->>ModelTrainingAgent: Performance Monitoring
                        ModelTrainingAgent->>Orchestrator: Optimized Model + Metrics

                        Orchestrator->>EvaluationAgent: Model Results + Image
                        EvaluationAgent->>EvaluationAgent: Clinical Validation
                        EvaluationAgent->>EvaluationAgent: Risk Assessment
                        EvaluationAgent->>EvaluationAgent: Quality Assurance
                        EvaluationAgent->>FinalReport: Comprehensive Analysis

                        Note over Image, FinalReport: Multi-agent analysis completed
                </div>
            </div>

            <!-- Dataset Information -->
            <div class="diagram-section">
                <h2 class="diagram-title">Dataset Integration</h2>
                <p class="diagram-description">
                    Integration of Kvasir-SEG and Kvasir-Sessile datasets for comprehensive polyp detection training
                </p>
                <div class="mermaid">
                    graph TB
                        subgraph DatasetInfo["üìä Dataset Information"]
                            KS["Kvasir-SEG Dataset<br/>1,000 polyp images<br/>Pixel-wise segmentation masks"]
                            KSS["Kvasir-Sessile Dataset<br/>196 polyp images<br/>Additional polyp variations"]
                            TC["Total Combined<br/>1,196 endoscopic images<br/>2 polyp classes"]
                        end
                        
                        subgraph DatasetFeatures["üîç Dataset Features"]
                            IM["Image Formats<br/>JPEG images<br/>PNG masks"]
                            RS["Resolution Range<br/>332√ó487 to 1920√ó1072<br/>Optimized to 640√ó640"]
                            AN["Annotations<br/>Manual annotation<br/>Expert verification"]
                            BB["Bounding Boxes<br/>JSON format<br/>Precise localization"]
                        end
                        
                        subgraph DatasetUsage["üéØ Dataset Usage"]
                            TR["Training<br/>Model training<br/>Feature learning"]
                            VA["Validation<br/>Model validation<br/>Performance testing"]
                            TE["Testing<br/>Final evaluation<br/>Clinical validation"]
                        end
                        
                        %% Connections
                        KS --> TC
                        KSS --> TC
                        TC --> IM
                        TC --> RS
                        TC --> AN
                        TC --> BB
                        
                        IM --> TR
                        RS --> VA
                        AN --> TE
                        BB --> TR
                        
                        %% Styling
                        classDef dataset fill:#20b2aa,stroke:#008b8b,stroke-width:2px,color:#000
                        classDef features fill:#2ecc71,stroke:#27ae60,stroke-width:2px,color:#000
                        classDef usage fill:#f39c12,stroke:#e67e22,stroke-width:2px,color:#000
                        
                        class KS,KSS,TC dataset
                        class IM,RS,AN,BB features
                        class TR,VA,TE usage
                </div>
            </div>

            <!-- Research Paper Information -->
            <div class="download-section">
                <h3>üìÑ Research Paper Ready Diagrams</h3>
                <p>These workflow diagrams are optimized for research paper presentation with clear 4-phase separation and comprehensive medical workflows.</p>
                <p style="margin-top: 15px;"><strong>Citation:</strong> Enhanced Gastrointestinal Polyp Detection using Deep Learning with Multi-Scale YOLO Detection and AI-Powered Medical Analysis</p>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            sequence: {
                useMaxWidth: true,
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: true,
                bottomMarginAdj: 1,
                useMaxWidth: true,
                rightAngles: false,
                showSequenceNumbers: false,
                actorFontSize: 14,
                noteFontSize: 14,
                messageFontSize: 16
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis',
                padding: 20
            },
            themeVariables: {
                primaryColor: '#20b2aa',
                primaryTextColor: '#fff',
                primaryBorderColor: '#008b8b',
                lineColor: '#2c3e50',
                secondaryColor: '#20b2aa',
                tertiaryColor: '#ed8936',
                noteBkgColor: '#fef5e7',
                noteTextColor: '#2d3748',
                noteBorderColor: '#ed8936'
            }
        });
    </script>
</body>
</html>