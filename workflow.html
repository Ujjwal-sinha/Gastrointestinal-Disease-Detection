<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gastrointestinal Polyp Detection - Workflow Diagrams</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #20b2aa 0%, #008b8b 100%);
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #20b2aa 0%, #008b8b 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        .content {
            padding: 30px;
        }
        .diagram-section {
            margin-bottom: 60px;
            padding: 30px;
            border-radius: 15px;
            background: #f8f9fa;
            border-left: 8px solid #20b2aa;
        }
        .diagram-title {
            color: #20b2aa;
            margin: 0 0 20px 0;
            font-size: 2em;
            text-align: center;
        }
        .diagram-description {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.1em;
            line-height: 1.6;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        .download-section {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #fef5e7;
            border-radius: 10px;
        }
        .download-btn {
            background: #20b2aa;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 0 10px;
            text-decoration: none;
            display: inline-block;
        }
        .download-btn:hover {
            background: #008b8b;
        }
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #20b2aa;
        }
        .feature-card h4 {
            color: #20b2aa;
            margin: 0 0 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ©º Gastrointestinal Polyp Detection System</h1>
            <p>AI-Powered Gastrointestinal Polyp Classification Workflow with YOLO Deep Learning & Multi-Model LLM Intelligence</p>
        </div>
        
        <div class="content">
            <!-- Phase 1: Endoscopic Image Upload & Quality Validation -->
            <div class="diagram-section">
                <h2 class="diagram-title">Phase 1: Endoscopic Image Upload & Quality Validation</h2>
                <p class="diagram-description">
                    Initial phase where the user uploads a gastrointestinal endoscopic image, followed by quality validation and preprocessing.
                    This includes format validation, quality scoring, and endoscopic-specific image optimization for accurate polyp detection.
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        participant User
                        participant StreamApp
                        participant ImageValidator
                        participant EndoscopicProcessor
                        participant ValidatedImage

                        Note over User, ValidatedImage: Phase 1: Endoscopic Image Upload & Quality Validation

                        User->>StreamApp: Upload Endoscopic Image
                        StreamApp->>StreamApp: Validate File Format (PNG/JPG/JPEG)
                        StreamApp->>ImageValidator: Check Image Quality
                        ImageValidator->>ImageValidator: Quality Score Calculation (0-1 scale)
                        ImageValidator->>EndoscopicProcessor: Quality Validated Image
                        EndoscopicProcessor->>EndoscopicProcessor: Endoscopic Image Normalization
                        EndoscopicProcessor->>EndoscopicProcessor: Contrast Enhancement (CLAHE)
                        EndoscopicProcessor->>EndoscopicProcessor: Resolution Standardization (640x640)
                        EndoscopicProcessor->>ValidatedImage: Processed Endoscopic Image

                        Note over User, ValidatedImage: Endoscopic preprocessing completed, ready for polyp classification
                </div>
            </div>

            <!-- Phase 2: YOLO Polyp Classification -->
            <div class="diagram-section">
                <h2 class="diagram-title">Phase 2: YOLO Polyp Classification</h2>
                <p class="diagram-description">
                    Advanced AI classification phase where YOLO11m analyzes the endoscopic image for gastrointestinal polyp detection with
                    real-time object detection, confidence scoring, and polyp type identification using deep learning.
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        participant ValidatedImage
                        participant YOLOModel
                        participant FeatureExtractor
                        participant DetectionHead
                        participant PolypClassifier
                        participant ConfidenceScorer

                        Note over ValidatedImage, ConfidenceScorer: Phase 2: YOLO Polyp Classification

                        ValidatedImage->>YOLOModel: Send Processed Endoscopic Image (640x640)
                        YOLOModel->>FeatureExtractor: Deep Feature Extraction (Conv Layers)
                        FeatureExtractor->>FeatureExtractor: Multi-layer Convolution & Pooling
                        FeatureExtractor->>DetectionHead: Extracted Feature Maps
                        DetectionHead->>DetectionHead: Object Detection Layers
                        DetectionHead->>PolypClassifier: Raw Detection Scores
                        PolypClassifier->>PolypClassifier: Multi-class Polyp Classification
                        PolypClassifier->>ConfidenceScorer: Polyp Type Prediction
                        ConfidenceScorer->>ConfidenceScorer: Confidence Score Calculation
                        ConfidenceScorer->>ConfidenceScorer: Probability Calibration (90%+ threshold)

                        Note over ValidatedImage, ConfidenceScorer: Polyp classification completed with high confidence scoring
                </div>
            </div>

            <!-- Phase 3: AI Agent Medical Analysis -->
            <div class="diagram-section">
                <h2 class="diagram-title">Phase 3: AI Agent Medical Analysis</h2>
                <p class="diagram-description">
                    AI-powered medical analysis using dual LLM models for comprehensive polyp assessment and treatment recommendations.
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        participant ConfidenceScorer
                        participant AIAgent
                        participant LLM1["llama-3.1-8b-instant"]
                        participant LLM2["qwen/qwen3-32b"]
                        participant Report

                        Note over ConfidenceScorer, Report: Phase 3: AI Medical Analysis

                        ConfidenceScorer->>AIAgent: Classification Results
                        AIAgent->>LLM1: Fast Analysis
                        AIAgent->>LLM2: Deep Analysis
                        LLM1->>AIAgent: Quick Assessment
                        LLM2->>AIAgent: Comprehensive Analysis
                        AIAgent->>Report: Medical Recommendations

                        Note over ConfidenceScorer, Report: AI analysis completed
                </div>
            </div>

            <!-- Phase 4: Polyp Region Detection & Reporting -->
            <div class="diagram-section">
                <h2 class="diagram-title">Phase 4: Polyp Region Detection & Reporting</h2>
                <p class="diagram-description">
                    Polyp region detection, visualization generation, and PDF report creation for clinical documentation.
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        participant Analysis
                        participant Detector
                        participant Visualizer
                        participant Report
                        participant User

                        Note over Analysis, User: Phase 4: Detection & Reporting

                        Analysis->>Detector: Classification Results
                        Detector->>Detector: Polyp Region Detection
                        Detector->>Visualizer: Annotated Image
                        Visualizer->>Visualizer: Generate Explanations
                        Visualizer->>Report: Visualizations & Findings
                        Report->>Report: Compile PDF Report
                        Report->>User: Download Report

                        Note over Analysis, User: Report completed
                </div>
            </div>

        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            sequence: {
                useMaxWidth: true,
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: true,
                bottomMarginAdj: 1,
                useMaxWidth: true,
                rightAngles: false,
                showSequenceNumbers: false,
                actorFontSize: 14,
                noteFontSize: 14,
                messageFontSize: 16
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis',
                padding: 20
            },
            themeVariables: {
                primaryColor: '#20b2aa',
                primaryTextColor: '#fff',
                primaryBorderColor: '#008b8b',
                lineColor: '#2c3e50',
                secondaryColor: '#20b2aa',
                tertiaryColor: '#ed8936',
                noteBkgColor: '#fef5e7',
                noteTextColor: '#2d3748',
                noteBorderColor: '#ed8936'
            }
        });
    </script>
</body>
</html>